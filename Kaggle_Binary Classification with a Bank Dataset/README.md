# Kaggle Competition: Binary Classification with a Bank Dataset/

**Проект выполнен в рамках соревнования на платформе Kaggle**
https://www.kaggle.com/competitions/playground-series-s5e8/overview

## Задача проекта

Разработать ML модель, позволяющую предсказывать, подпишется ли клиент банка на депозит или нет (1 - да/ 0 - нет)

## Описание данных

* train.csv - обучающий набор данных, 'y' - целевая переменная.  
* test.csv - тестовый набор данных; цель - предсказать вероятность 'y' для каждой строки    
* sample_submit.csv - файл предсказаний в правильном формате.  


**Описание данных**

| Признак     | Описание                                                                    |
| ----------- | --------------------------------------------------------------------------- |
| `id`        | Идентификатор клиента                                                       |
| `age`       | Возраст клиента                                                             |
| `job`       | Профессия (admin, blue-collar и др.)                              |
| `marital`   | Семейное положение (married, single, divorced)                              |
| `education` | Уровень образования (primary, secondary, tertiary, unknown)                 |
| `default`   | Есть ли дефолт по кредиту (yes/no)                                          |
| `balance`   | Средний баланс на счёте                                           |
| `housing`   | Есть ли ипотека (yes/no)                                                    |
| `loan`      | Есть ли персональный кредит (yes/no)                                        |
| `contact`   | Способ связи (cellular, telephone)                                          |
| `day`       | День месяца последнего контакта                                             |
| `month`     | Месяц последнего контакта                                                   |
| `duration`  | Длительность последнего звонка (в секундах)                                 |
| `campaign`  | Количество контактов в рамках кампании с данным клиентом                    |
| `pdays`     | Дни после последней маркетинговой кампании (-1 — не контактировали ранее)  |
| `previous`  | Количество контактов до текущей кампании                                    |
| `poutcome`  | Результат предыдущей кампании (success, failure, unknown)                   |
| `y`         | Целевая переменная: подписка на депозит (yes = 1, no = 0)                   |

## План исследования

1. Загрузка библиотек и файлов
2. Исследовательский анализ данных
    * Баланс классов
    * Анализ числовых признаков
    * Анализ категориальных признаков
3. Создание новых признаков (Feature engineering)
4. Проверка значений на мультиколлинеарность
5. Проверка важности признаков (Mutual Information)
6. Отбор признаков
7. Обучение моделей с использованием Pipeline и GridSearchCV
8. Проверка лучшей модели на адекватность с помощью константной модели DummyClassifier
9. Финальное предсказание на тестовой выборке
10. Проверка важности признаков (Feature Importances)
11. Вывод

## Решение

В результате исследовательского анализа данных (EDA) обнаружили сильный дисбаланс целевой переменной: 87.93% клиентов отказались от депозита, и только 12.07% согласились. Этот дисбаланс был учтён при обучении моделей (с помощью class_weight или auto_class_weights), чтобы избежать смещения прогнозов в сторону большинства.

Для улучшения предсказательной способности моделей был выполнен feature engineering: созданы новые признаки, связанные с длительностью звонка (логарифм, деление на количество контактов, бины), а также взаимодействия числовых признаков (balance/age, campaign * previous). Эти признаки позволили моделям лучше улавливать сложные зависимости между клиентами и их поведением.

На этапе обучения моделей, использовались 3 алгоритма с GridSearchCV и метрикой ROC-AUC для оценки качества:

- Logistic Regression (0.94)
- XGBoost (0.96)
- CatBoostClassifier (0.964), который показал наилучший результат.

Для проверки стабильности модели CatBoostClassifier применили её к тестовым данным. Результаты на платформе Kaggle продемонстрировали высокую стабильность предсказаний: Private Score = 0.96487, Public Score = 0.96524.

Анализ важности признаков показал, что наибольшее влияние на отклик имеют месяц контакта, длительность звонка и её логарифм, способ связи, наличие ипотеки, успех предыдущей кампании и день месяца контакта. Финансовые и демографические характеристики оказывают второстепенное влияние.

## Используемые библиотеки и инструменты

Pandas, NumPy, Matplotlib, Seaborn, Sklearn, Phik, Сollections, XGBoost, Catboost


